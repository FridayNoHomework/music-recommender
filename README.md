# music-recommender
Final Project for FRE7773

## intro of the project
This project is a music recommender. Given a set of input songs, the recommender outputs a list of recommended songs. The primary basis for recommendations involves representing all songs as vectors. When a user inputs their preferred songs, we create their taste vector (for simplicity, it is the average of the vectors of the songs they input). To recommend k songs, the recommender identifies the k song vectors closest (according to cosine similarity) to the taste vector.

This project involves machine learning models specifically in the vectorization of textual features for songs. Two crucial textual features for songs are genre and artists. The recommender utilizes word2vec to vectorize these features. Word2vec is trained using user playlists, treating the song features in each user playlist as words within a context.

We partition all user playlists into three parts: one for training, one for validating, and one for testing. The validation set is employed to fine-tune the "windows" hyperparameter. The testing set is used to compare the recommender based on the word2vec model with other benchmark models, which includes vectorization methods that do not consider the user-song relationship. The first one utilizes vectors containing only numerical features. The second one utilizes vectors containing both numerical and text features. In this case, the text features are vectorized using the tf-idf method, which is based on the word frequency in the features. The metrics used for validation and testing are both Hit@K.

## Data
Our datasets come from two sources. The  one of users’ playlists comes from [Spotify Million Playlist Dataset Challenge](https://www.aicrowd.com/challenges/spotify-million-playlist-dataset-challenge) , the other of Spotify songs’ information comes from [Hugging Face](https://huggingface.co/datasets/maharshipandya/spotify-tracks-dataset). 

The raw data for this project is substantial in size, making it impractical to upload directly to GitHub. As a result, only the processed data, obtained after thorough cleaning and merging, has been included in this repository. The code for cleaning and merging the raw data is available in `notebooks/data_preprocessing.ipynb`.

## Project Overview

### Data Processing:

- The raw data undergoes processing, involving cleaning and merging operations. Processed files are saved in `data/processed_data/common.csv`.

**Note: The original CSV file is 200MB, making it impractical for direct upload. On GitHub, it is available as a compressed ZIP file. After downloading, to run the project, it is necessary to extract the contents into CSV format.**

### Exploratory Data Analysis (EDA):

- Exploratory Data Analysis is conducted to gain insights into the data. The corresponding code is available in the `notebooks` folder.

### Recommendation Flow:

- The primary recommendation flow is encapsulated in `code/recommend_flow.py`. This script handles model training, hyperparameter tuning, and benchmarking.

### Utilized Classes:

- Classes defined in the `code` folder are instrumental in the recommendation flow:
  - `GetTextMat`: Transforms text features into vectors using Word2Vec or benchmark models.
  - `ContentRec`: Recommender class that suggests songs based on song vectors, song data and user input.
  - `HitKCal`: Class responsible for calculating Hit@K.

### Intermediate Files:

- `recommend_flow.py` generates intermediate files:
  - `processed_data/song_data.csv` and `serialized_data/w2v_mat.pkl` store the vector space produced by the optimal Word2Vec model and the corresponding song data for the demo app.
  - `serialized_data/test_result.pkl` contains Hit@K matrices for different models during the testing phase, utilized by `PlotTestResult.py` for visualization.

### Demo Execution:

- To run the demo, execute `streamlit run myapp.py` in the `code` folder.

### Results:

Generated result images are located in the `results` folder. 

- **comet_validation:**
  This displays a screenshot of the hyperparameter tuning results recorded on Comet.
- **comet_test:**
  This shows a screenshot of the comparison results between Word2Vec (w2v) and benchmark models recorded on Comet.
- **TestResult:**
  The screenshot displays the results of the comparison between Word2Vec and benchmark models. This was generated by running `code/PlotTestResult.py`.







